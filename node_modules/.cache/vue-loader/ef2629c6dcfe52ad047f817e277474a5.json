{"remainingRequest":"/home/artur/programowanie/organiser/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/artur/programowanie/organiser/src/components/RoutineCalendar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/artur/programowanie/organiser/src/components/RoutineCalendar.vue","mtime":1625156798936},{"path":"/home/artur/programowanie/organiser/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/artur/programowanie/organiser/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/artur/programowanie/organiser/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/artur/programowanie/organiser/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUm91dGluZUNhbGVuZGFyIiwKICBkYXRhOiAoKSA9PiAoewogICAgdmFsdWU6ICIiLAogICAgZXZlbnRzOiBbXSwKICAgIGNvbG9yczogWwogICAgICAiIzIxOTZGMyIsCiAgICAgICIjM0Y1MUI1IiwKICAgICAgIiM2NzNBQjciLAogICAgICAiIzAwQkNENCIsCiAgICAgICIjNENBRjUwIiwKICAgICAgIiNGRjk4MDAiLAogICAgICAiIzc1NzU3NSIsCiAgICBdLAogICAgbmFtZXM6IFsKICAgICAgIk1lZXRpbmciLAogICAgICAiSG9saWRheSIsCiAgICAgICJQVE8iLAogICAgICAiVHJhdmVsIiwKICAgICAgIkV2ZW50IiwKICAgICAgIkJpcnRoZGF5IiwKICAgICAgIkNvbmZlcmVuY2UiLAogICAgICAiUGFydHkiLAogICAgXSwKICAgIGRyYWdFdmVudDogbnVsbCwKICAgIGRyYWdTdGFydDogbnVsbCwKICAgIGNyZWF0ZUV2ZW50OiBudWxsLAogICAgY3JlYXRlU3RhcnQ6IG51bGwsCiAgICBleHRlbmRPcmlnaW5hbDogbnVsbCwKICB9KSwKICBtZXRob2RzOiB7CiAgICBzdGFydERyYWcoeyBldmVudCwgdGltZWQgfSkgewogICAgICBpZiAoZXZlbnQgJiYgdGltZWQpIHsKICAgICAgICB0aGlzLmRyYWdFdmVudCA9IGV2ZW50OwogICAgICAgIHRoaXMuZHJhZ1RpbWUgPSBudWxsOwogICAgICAgIHRoaXMuZXh0ZW5kT3JpZ2luYWwgPSBudWxsOwogICAgICB9CiAgICB9LAogICAgc3RhcnRUaW1lKHRtcykgewogICAgICBjb25zdCBtb3VzZSA9IHRoaXMudG9UaW1lKHRtcyk7CgogICAgICBpZiAodGhpcy5kcmFnRXZlbnQgJiYgdGhpcy5kcmFnVGltZSA9PT0gbnVsbCkgewogICAgICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy5kcmFnRXZlbnQuc3RhcnQ7CgogICAgICAgIHRoaXMuZHJhZ1RpbWUgPSBtb3VzZSAtIHN0YXJ0OwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY3JlYXRlU3RhcnQgPSB0aGlzLnJvdW5kVGltZShtb3VzZSk7CiAgICAgICAgdGhpcy5jcmVhdGVFdmVudCA9IHsKICAgICAgICAgIG5hbWU6IGBFdmVudCAjJHt0aGlzLmV2ZW50cy5sZW5ndGh9YCwKICAgICAgICAgIGNvbG9yOiB0aGlzLnJuZEVsZW1lbnQodGhpcy5jb2xvcnMpLAogICAgICAgICAgc3RhcnQ6IHRoaXMuY3JlYXRlU3RhcnQsCiAgICAgICAgICBlbmQ6IHRoaXMuY3JlYXRlU3RhcnQsCiAgICAgICAgICB0aW1lZDogdHJ1ZSwKICAgICAgICB9OwoKICAgICAgICB0aGlzLmV2ZW50cy5wdXNoKHRoaXMuY3JlYXRlRXZlbnQpOwogICAgICB9CiAgICB9LAogICAgZXh0ZW5kQm90dG9tKGV2ZW50KSB7CiAgICAgIHRoaXMuY3JlYXRlRXZlbnQgPSBldmVudDsKICAgICAgdGhpcy5jcmVhdGVTdGFydCA9IGV2ZW50LnN0YXJ0OwogICAgICB0aGlzLmV4dGVuZE9yaWdpbmFsID0gZXZlbnQuZW5kOwogICAgfSwKICAgIG1vdXNlTW92ZSh0bXMpIHsKICAgICAgY29uc3QgbW91c2UgPSB0aGlzLnRvVGltZSh0bXMpOwoKICAgICAgaWYgKHRoaXMuZHJhZ0V2ZW50ICYmIHRoaXMuZHJhZ1RpbWUgIT09IG51bGwpIHsKICAgICAgICBjb25zdCBzdGFydCA9IHRoaXMuZHJhZ0V2ZW50LnN0YXJ0OwogICAgICAgIGNvbnN0IGVuZCA9IHRoaXMuZHJhZ0V2ZW50LmVuZDsKICAgICAgICBjb25zdCBkdXJhdGlvbiA9IGVuZCAtIHN0YXJ0OwogICAgICAgIGNvbnN0IG5ld1N0YXJ0VGltZSA9IG1vdXNlIC0gdGhpcy5kcmFnVGltZTsKICAgICAgICBjb25zdCBuZXdTdGFydCA9IHRoaXMucm91bmRUaW1lKG5ld1N0YXJ0VGltZSk7CiAgICAgICAgY29uc3QgbmV3RW5kID0gbmV3U3RhcnQgKyBkdXJhdGlvbjsKCiAgICAgICAgdGhpcy5kcmFnRXZlbnQuc3RhcnQgPSBuZXdTdGFydDsKICAgICAgICB0aGlzLmRyYWdFdmVudC5lbmQgPSBuZXdFbmQ7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5jcmVhdGVFdmVudCAmJiB0aGlzLmNyZWF0ZVN0YXJ0ICE9PSBudWxsKSB7CiAgICAgICAgY29uc3QgbW91c2VSb3VuZGVkID0gdGhpcy5yb3VuZFRpbWUobW91c2UsIGZhbHNlKTsKICAgICAgICBjb25zdCBtaW4gPSBNYXRoLm1pbihtb3VzZVJvdW5kZWQsIHRoaXMuY3JlYXRlU3RhcnQpOwogICAgICAgIGNvbnN0IG1heCA9IE1hdGgubWF4KG1vdXNlUm91bmRlZCwgdGhpcy5jcmVhdGVTdGFydCk7CgogICAgICAgIHRoaXMuY3JlYXRlRXZlbnQuc3RhcnQgPSBtaW47CiAgICAgICAgdGhpcy5jcmVhdGVFdmVudC5lbmQgPSBtYXg7CiAgICAgIH0KICAgIH0sCiAgICBlbmREcmFnKCkgewogICAgICB0aGlzLmRyYWdUaW1lID0gbnVsbDsKICAgICAgdGhpcy5kcmFnRXZlbnQgPSBudWxsOwogICAgICB0aGlzLmNyZWF0ZUV2ZW50ID0gbnVsbDsKICAgICAgdGhpcy5jcmVhdGVTdGFydCA9IG51bGw7CiAgICAgIHRoaXMuZXh0ZW5kT3JpZ2luYWwgPSBudWxsOwogICAgfSwKICAgIGNhbmNlbERyYWcoKSB7CiAgICAgIGlmICh0aGlzLmNyZWF0ZUV2ZW50KSB7CiAgICAgICAgaWYgKHRoaXMuZXh0ZW5kT3JpZ2luYWwpIHsKICAgICAgICAgIHRoaXMuY3JlYXRlRXZlbnQuZW5kID0gdGhpcy5leHRlbmRPcmlnaW5hbDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgaSA9IHRoaXMuZXZlbnRzLmluZGV4T2YodGhpcy5jcmVhdGVFdmVudCk7CiAgICAgICAgICBpZiAoaSAhPT0gLTEpIHsKICAgICAgICAgICAgdGhpcy5ldmVudHMuc3BsaWNlKGksIDEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5jcmVhdGVFdmVudCA9IG51bGw7CiAgICAgIHRoaXMuY3JlYXRlU3RhcnQgPSBudWxsOwogICAgICB0aGlzLmRyYWdUaW1lID0gbnVsbDsKICAgICAgdGhpcy5kcmFnRXZlbnQgPSBudWxsOwogICAgfSwKICAgIHJvdW5kVGltZSh0aW1lLCBkb3duID0gdHJ1ZSkgewogICAgICBjb25zdCByb3VuZFRvID0gMTU7IC8vIG1pbnV0ZXMKICAgICAgY29uc3Qgcm91bmREb3duVGltZSA9IHJvdW5kVG8gKiA2MCAqIDEwMDA7CgogICAgICByZXR1cm4gZG93bgogICAgICAgID8gdGltZSAtICh0aW1lICUgcm91bmREb3duVGltZSkKICAgICAgICA6IHRpbWUgKyAocm91bmREb3duVGltZSAtICh0aW1lICUgcm91bmREb3duVGltZSkpOwogICAgfSwKICAgIHRvVGltZSh0bXMpIHsKICAgICAgcmV0dXJuIG5ldyBEYXRlKAogICAgICAgIHRtcy55ZWFyLAogICAgICAgIHRtcy5tb250aCAtIDEsCiAgICAgICAgdG1zLmRheSwKICAgICAgICB0bXMuaG91ciwKICAgICAgICB0bXMubWludXRlCiAgICAgICkuZ2V0VGltZSgpOwogICAgfSwKICAgIGdldEV2ZW50Q29sb3IoZXZlbnQpIHsKICAgICAgY29uc3QgcmdiID0gcGFyc2VJbnQoZXZlbnQuY29sb3Iuc3Vic3RyaW5nKDEpLCAxNik7CiAgICAgIGNvbnN0IHIgPSAocmdiID4+IDE2KSAmIDB4ZmY7CiAgICAgIGNvbnN0IGcgPSAocmdiID4+IDgpICYgMHhmZjsKICAgICAgY29uc3QgYiA9IChyZ2IgPj4gMCkgJiAweGZmOwoKICAgICAgcmV0dXJuIGV2ZW50ID09PSB0aGlzLmRyYWdFdmVudAogICAgICAgID8gYHJnYmEoJHtyfSwgJHtnfSwgJHtifSwgMC43KWAKICAgICAgICA6IGV2ZW50ID09PSB0aGlzLmNyZWF0ZUV2ZW50CiAgICAgICAgPyBgcmdiYSgke3J9LCAke2d9LCAke2J9LCAwLjcpYAogICAgICAgIDogZXZlbnQuY29sb3I7CiAgICB9LAogICAgZ2V0RXZlbnRzKHsgc3RhcnQsIGVuZCB9KSB7CiAgICAgIGNvbnN0IGV2ZW50cyA9IFtdOwoKICAgICAgY29uc3QgbWluID0gbmV3IERhdGUoYCR7c3RhcnQuZGF0ZX1UMDA6MDA6MDBgKS5nZXRUaW1lKCk7CiAgICAgIGNvbnN0IG1heCA9IG5ldyBEYXRlKGAke2VuZC5kYXRlfVQyMzo1OTo1OWApLmdldFRpbWUoKTsKICAgICAgY29uc3QgZGF5cyA9IChtYXggLSBtaW4pIC8gODY0MDAwMDA7CiAgICAgIGNvbnN0IGV2ZW50Q291bnQgPSB0aGlzLnJuZChkYXlzLCBkYXlzICsgMjApOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBldmVudENvdW50OyBpKyspIHsKICAgICAgICBjb25zdCB0aW1lZCA9IHRoaXMucm5kKDAsIDMpICE9PSAwOwogICAgICAgIGNvbnN0IGZpcnN0VGltZXN0YW1wID0gdGhpcy5ybmQobWluLCBtYXgpOwogICAgICAgIGNvbnN0IHNlY29uZFRpbWVzdGFtcCA9IHRoaXMucm5kKDIsIHRpbWVkID8gOCA6IDI4OCkgKiA5MDAwMDA7CiAgICAgICAgY29uc3Qgc3RhcnQgPSBmaXJzdFRpbWVzdGFtcCAtIChmaXJzdFRpbWVzdGFtcCAlIDkwMDAwMCk7CiAgICAgICAgY29uc3QgZW5kID0gc3RhcnQgKyBzZWNvbmRUaW1lc3RhbXA7CgogICAgICAgIGV2ZW50cy5wdXNoKHsKICAgICAgICAgIG5hbWU6IHRoaXMucm5kRWxlbWVudCh0aGlzLm5hbWVzKSwKICAgICAgICAgIGNvbG9yOiB0aGlzLnJuZEVsZW1lbnQodGhpcy5jb2xvcnMpLAogICAgICAgICAgc3RhcnQsCiAgICAgICAgICBlbmQsCiAgICAgICAgICB0aW1lZCwKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdGhpcy5ldmVudHMgPSBldmVudHM7CiAgICB9LAogICAgcm5kKGEsIGIpIHsKICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKGIgLSBhICsgMSkgKiBNYXRoLnJhbmRvbSgpKSArIGE7CiAgICB9LAogICAgcm5kRWxlbWVudChhcnIpIHsKICAgICAgcmV0dXJuIGFyclt0aGlzLnJuZCgwLCBhcnIubGVuZ3RoIC0gMSldOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["RoutineCalendar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"RoutineCalendar.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <v-row class=\"fill-height\">\n    <v-col>\n      <v-sheet height=\"600\">\n        <v-calendar\n          ref=\"calendar\"\n          v-model=\"value\"\n          color=\"black\"\n          type=\"week\"\n          :events=\"events\"\n          :event-color=\"getEventColor\"\n          :event-ripple=\"false\"\n          @change=\"getEvents\"\n          @mousedown:event=\"startDrag\"\n          @mousedown:time=\"startTime\"\n          @mousemove:time=\"mouseMove\"\n          @mouseup:time=\"endDrag\"\n          @mouseleave.native=\"cancelDrag\"\n        >\n          <template v-slot:event=\"{ event, timed, eventSummary }\">\n            <div class=\"v-event-draggable\" v-html=\"eventSummary()\"></div>\n            <div\n              v-if=\"timed\"\n              class=\"v-event-drag-bottom\"\n              @mousedown.stop=\"extendBottom(event)\"\n            ></div>\n          </template>\n        </v-calendar>\n      </v-sheet>\n    </v-col>\n  </v-row>\n</template>\n\n<script>\nexport default {\n  name: \"RoutineCalendar\",\n  data: () => ({\n    value: \"\",\n    events: [],\n    colors: [\n      \"#2196F3\",\n      \"#3F51B5\",\n      \"#673AB7\",\n      \"#00BCD4\",\n      \"#4CAF50\",\n      \"#FF9800\",\n      \"#757575\",\n    ],\n    names: [\n      \"Meeting\",\n      \"Holiday\",\n      \"PTO\",\n      \"Travel\",\n      \"Event\",\n      \"Birthday\",\n      \"Conference\",\n      \"Party\",\n    ],\n    dragEvent: null,\n    dragStart: null,\n    createEvent: null,\n    createStart: null,\n    extendOriginal: null,\n  }),\n  methods: {\n    startDrag({ event, timed }) {\n      if (event && timed) {\n        this.dragEvent = event;\n        this.dragTime = null;\n        this.extendOriginal = null;\n      }\n    },\n    startTime(tms) {\n      const mouse = this.toTime(tms);\n\n      if (this.dragEvent && this.dragTime === null) {\n        const start = this.dragEvent.start;\n\n        this.dragTime = mouse - start;\n      } else {\n        this.createStart = this.roundTime(mouse);\n        this.createEvent = {\n          name: `Event #${this.events.length}`,\n          color: this.rndElement(this.colors),\n          start: this.createStart,\n          end: this.createStart,\n          timed: true,\n        };\n\n        this.events.push(this.createEvent);\n      }\n    },\n    extendBottom(event) {\n      this.createEvent = event;\n      this.createStart = event.start;\n      this.extendOriginal = event.end;\n    },\n    mouseMove(tms) {\n      const mouse = this.toTime(tms);\n\n      if (this.dragEvent && this.dragTime !== null) {\n        const start = this.dragEvent.start;\n        const end = this.dragEvent.end;\n        const duration = end - start;\n        const newStartTime = mouse - this.dragTime;\n        const newStart = this.roundTime(newStartTime);\n        const newEnd = newStart + duration;\n\n        this.dragEvent.start = newStart;\n        this.dragEvent.end = newEnd;\n      } else if (this.createEvent && this.createStart !== null) {\n        const mouseRounded = this.roundTime(mouse, false);\n        const min = Math.min(mouseRounded, this.createStart);\n        const max = Math.max(mouseRounded, this.createStart);\n\n        this.createEvent.start = min;\n        this.createEvent.end = max;\n      }\n    },\n    endDrag() {\n      this.dragTime = null;\n      this.dragEvent = null;\n      this.createEvent = null;\n      this.createStart = null;\n      this.extendOriginal = null;\n    },\n    cancelDrag() {\n      if (this.createEvent) {\n        if (this.extendOriginal) {\n          this.createEvent.end = this.extendOriginal;\n        } else {\n          const i = this.events.indexOf(this.createEvent);\n          if (i !== -1) {\n            this.events.splice(i, 1);\n          }\n        }\n      }\n\n      this.createEvent = null;\n      this.createStart = null;\n      this.dragTime = null;\n      this.dragEvent = null;\n    },\n    roundTime(time, down = true) {\n      const roundTo = 15; // minutes\n      const roundDownTime = roundTo * 60 * 1000;\n\n      return down\n        ? time - (time % roundDownTime)\n        : time + (roundDownTime - (time % roundDownTime));\n    },\n    toTime(tms) {\n      return new Date(\n        tms.year,\n        tms.month - 1,\n        tms.day,\n        tms.hour,\n        tms.minute\n      ).getTime();\n    },\n    getEventColor(event) {\n      const rgb = parseInt(event.color.substring(1), 16);\n      const r = (rgb >> 16) & 0xff;\n      const g = (rgb >> 8) & 0xff;\n      const b = (rgb >> 0) & 0xff;\n\n      return event === this.dragEvent\n        ? `rgba(${r}, ${g}, ${b}, 0.7)`\n        : event === this.createEvent\n        ? `rgba(${r}, ${g}, ${b}, 0.7)`\n        : event.color;\n    },\n    getEvents({ start, end }) {\n      const events = [];\n\n      const min = new Date(`${start.date}T00:00:00`).getTime();\n      const max = new Date(`${end.date}T23:59:59`).getTime();\n      const days = (max - min) / 86400000;\n      const eventCount = this.rnd(days, days + 20);\n\n      for (let i = 0; i < eventCount; i++) {\n        const timed = this.rnd(0, 3) !== 0;\n        const firstTimestamp = this.rnd(min, max);\n        const secondTimestamp = this.rnd(2, timed ? 8 : 288) * 900000;\n        const start = firstTimestamp - (firstTimestamp % 900000);\n        const end = start + secondTimestamp;\n\n        events.push({\n          name: this.rndElement(this.names),\n          color: this.rndElement(this.colors),\n          start,\n          end,\n          timed,\n        });\n      }\n\n      this.events = events;\n    },\n    rnd(a, b) {\n      return Math.floor((b - a + 1) * Math.random()) + a;\n    },\n    rndElement(arr) {\n      return arr[this.rnd(0, arr.length - 1)];\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.v-event-draggable {\n  padding-left: 6px;\n}\n\n.v-event-timed {\n  user-select: none;\n  -webkit-user-select: none;\n}\n\n.v-event-drag-bottom {\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 4px;\n  height: 4px;\n  cursor: ns-resize;\n\n  &::after {\n    display: none;\n    position: absolute;\n    left: 50%;\n    height: 4px;\n    border-top: 1px solid white;\n    border-bottom: 1px solid white;\n    width: 16px;\n    margin-left: -8px;\n    opacity: 0.8;\n    content: \"\";\n  }\n\n  &:hover::after {\n    display: block;\n  }\n}\n</style>\nParty\n"]}]}